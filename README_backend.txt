Event Analytics Backend – README.txt
====================================

Overview
--------
This project is a simple Node.js + Express backend that connects to a Supabase
database and returns analytics for events.

It exposes one main endpoint:

  GET /api/events/:id/summary

For a given event_id, the API returns:
- Total RSVP count
- Actual attendance
- Attendance rate (actual attendance / "Going" RSVPs)
- Average star rating
- Comments and recommendation flags
- Department and major distribution (via the students table)


Repository contents
-------------------
Recommended files in this repo:

- dashboard.js
    Main backend server. Sets up Express, CORS, Supabase client, and defines
    the /api/events/:id/summary endpoint.

- package.json
    Lists dependencies and npm scripts (including the start script).

- package-lock.json
    Exact versions of installed dependencies (generated by npm).

- db/schema.sql        (example name, optional but recommended)
    SQL script to create required tables (students, rsvps, attendance, feedback).

- db/seed.sql          (example name, optional)
    SQL script with sample rows for testing.

Update the names/paths above to match your actual SQL files if they differ.


Supabase setup (Ignore This Part for Frontend)
--------------
1) Create a Supabase project.

2) In your Supabase project, create the following tables (or equivalent):
   - students (id, department, major, etc.)
   - rsvps (id, event_id, student_id, rsvp_status, etc.)
   - attendance (id, event_id, student_id, etc.)
   - feedback (id, event_id, student_id, rating, comment_text, would_recommend, etc.)

3) Get your Supabase project URL and anon key from the 'Project Settings' → 'API'
   section in the Supabase dashboard.

4) In dashboard.js, configure:

   const supabaseUrl = 'https://YOUR-PROJECT-REF.supabase.co';
   const supabaseKey = 'YOUR_SUPABASE_ANON_KEY';

For real deployments, these should be stored in environment variables instead
of hard-coded in the file.


Install and run (from the terminal)
-----------------------------------
Prerequisites:
- Node.js (v18+ recommended)
- npm (installed with Node)

Steps:

1) Clone this repository:

   git clone <your-repo-url>
   cd <your-repo-folder>

2) Install dependencies:

   npm install

3) (Optional) Check the "start" script in package.json.

   In package.json, under "scripts", you should have:

     "scripts": {
       "start": "node dashboard.js"
     }

   If it is missing, add it manually.

4) Run the backend server:

   Option A: using npm

     npm start

   Option B: directly with Node

     node dashboard.js

   If it starts successfully, you should see:

     Backend server running on http://localhost:3000


Testing the API
---------------
Once the server is running on http://localhost:3000, you can test the endpoint.

Use a browser:

  http://localhost:3000/api/events/1/summary

(Replace 1 with an event_id that actually exists in your database.)

Or use curl from the terminal:

  curl http://localhost:3000/api/events/1/summary

If everything is configured correctly, you should get a JSON response similar to:

  {
    "eventId": 1,
    "rsvpCount": 25,
    "rsvps": [ ... ],
    "actualAttendance": 18,
    "attendanceRate": 0.72,
    "averageRating": 4.3,
    "comments": [ ... ],
    "departments": {
      "Computer Engineering": 10,
      "Mechanical Engineering": 8
    },
    "majors": {
      "Software Engineering": 5,
      "Biomedical Engineering": 3
    }
  }


Using this backend from a frontend
----------------------------------
This backend is meant to be consumed by a separate frontend (for example,
a React/Vite dashboard app). The basic pattern on the frontend is:

  fetch('http://localhost:3000/api/events/1/summary')
    .then(res => res.json())
    .then(data => {
      // display charts, cards, tables, etc. using "data"
    });

Because CORS is enabled in dashboard.js:

  app.use(cors());

a frontend running on another port (such as http://localhost:5173) can
successfully call this backend during development.


Common issues
-------------
1) Error: "Cannot find module '/path/to/dashboard.js'"

   - The terminal is in the wrong directory, or the filename is different.
   - Fix:
       cd into the folder that actually contains dashboard.js, then run:

         node dashboard.js

       Example:

         cd /Users/ahmedaly/Desktop/CPS714_Code
         ls        # Make sure you see dashboard.js in the listing
         node dashboard.js

2) Supabase authentication or connection errors

   - Check that:
     - supabaseUrl and supabaseKey are correct.
     - You are using the anon/public key for the frontend-facing backend.
     - Tables and column names in Supabase match what dashboard.js expects.

3) Empty or missing data

   - Make sure your SQL schema and sample data are loaded into Supabase
     (using the Supabase SQL editor or psql).
   - Ensure that the event_id you request (e.g., /api/events/1/summary)
     actually exists in rsvps/attendance/feedback tables.


License
-------
Add your chosen license information here (MIT, Apache-2.0, etc.) if needed.
